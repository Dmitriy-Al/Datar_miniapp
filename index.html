<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://telegram.org/js/telegram-web-app.js?59"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <h1>Version 1</h1>
  <body>
    <div class="output-container">
      <output class="output" id="text"> </output>
    </div>

    <div>
      <button class="but" id="test" onclick="action()">Test</button>
    </div>

    <div>
      <button class="but" id="cre">CREATE</button>
    </div>

    <div>
      <button class="but" id="sho">SHOW</button>
    </div>

    <div>
      <button class="but" id="del">DELETE</button>
    </div>
  </body>
</html>

<script>
  const API_BASE = "http://176.123.166.19:8080/api";

  let tg = window.Telegram.WebApp;
  const cloudStorage = tg.CloudStorage;

  const button = document.getElementById("test");
  const output = document.getElementById("text");

  const create = document.getElementById("cre");
  const show = document.getElementById("sho");
  const delet = document.getElementById("del");

  create.addEventListener("click", () => {
    output.innerHTML = "";

    const object = {
      // message
      id: 1,
      name: "Lera",
      //parseInt(document.getElementById("id").value)
    };

    try {
      const response = fetch(`${API_BASE}/testdb`, {
        // база данных
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(object),
      });

      if (response.ok) {
        alert("Message sent successfully!");
        document.getElementById("messageForm").reset();
        loadMessages();
      } else {
        throw new Error("Failed to send message");
      }
    } catch (error) {
      console.error("Error:", error);
      alert("Error sending message");
    }

    output.append(" <Success> ");
  });

  show.addEventListener("click", () => {
    output.innerHTML = "";
  });

  delet.addEventListener("click", () => {
    output.innerHTML = "";
  });

  function action() {
    output.innerHTML = "";
    let data1 = tg.initDataUnsafe.user.first_name;
    output.append(" " + data1 + " ");

    tg.WebApp.sendData("Test data from web app");
  }

  /*

  button.addEventListener("click", function () {
    alert(`ALERT`);
  });
 

   */
</script>

<style>
  .output-container {
    width: 500px;
    height: 200px;
    background-color: rgb(86, 152, 228);
    padding: 20px;
  }
  .output {
    width: 450px;
    height: 190px;
    background-color: rgb(178, 247, 230);
    margin: 10px;
    padding: 20px;
  }
  .but {
    background-color: rgb(8, 255, 193);
    padding: 20px;
  }
  .but:hover {
    background-color: rgb(4, 202, 153);
  }
</style>
